<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Connexion</title>
    <link rel="stylesheet" href="style-login.css">
</head>

<body class="login-body">

<div class="login-card">

    <div class="top-banner">
        <!-- TON LOGO DANS LE BANDEAU -->
        <img src="Images_Icones/user_bleu_vide.png" class="banner-logo" alt="Logo">
    </div>

    <h2 class="connexion">Connexion</h2>

    <!-- Identifiant -->
    <div class="input-group">
        <span class="icon">ðŸ‘¤</span>
        <input type="text" id="username" placeholder="Identifiant">
    </div>

    <!-- Mot de passe -->
    <div class="input-group">
        <span class="icon">ðŸ”’</span>
        <input type="password" id="password" placeholder="Mot de passe">
    </div>

    <!-- Bouton -->
    <button class="submit-btn" id="loginBtn">Se connecter</button>

    <!-- Message dâ€™erreur -->
    <p id="loginMessage"></p>

</div>

<script>
const API_URL = "http://localhost:3000/api/auth";

document.getElementById("loginBtn").addEventListener("click", async () => {
    const user = document.getElementById("username").value;
    const pass = document.getElementById("password").value;
    const messageBox = document.getElementById("loginMessage");

    try {
        const response = await fetch(`${API_URL}/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username: user, password: pass }),
            credentials: "include" // TRES IMPORTANT : Permet de garder la session (cookie)
        });

        const data = await response.json();

        if (response.ok && data.success) {
            // On stocke juste un marqueur visuel, mais la vraie sÃ©curitÃ© est dans le cookie session
            localStorage.setItem("loggedIn", "true"); 
            window.location.href = "index.html";
        } else {
            showMessage(data.error || "Erreur de connexion");
        }
    } catch (err) {
        console.error(err);
        showMessage("Impossible de contacter le serveur");
    }
});

function showMessage(msg) {
    const m = document.getElementById("loginMessage");
    m.textContent = msg;
    m.style.color = "red";
}
</script>

</body>
</html>
